<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<!-- AIzaSyAdpFt44gVyyLaVVx9o9gHNo11umONL3Uw-->
<style>
#gmap {
	width: 100%;
	height: 800px;
	border: 2px solid gray
}
#g{position : relative;}
#geocodeSearch {
	position: absolute;
	top:50px;
	left: 300px;
	border: 1px solid gray;
	background: #fff;
	z-index: 100;
	text-align:center;
}
</style>
<!-- 지명, 건물명등의 이름으로 지도 사용하기 -->
<script async defer
	src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAdpFt44gVyyLaVVx9o9gHNo11umONL3Uw&callback=initMap"></script>
</head>
<body>
	<div id="g">
		<div id="geocodeSearch">
			<input type='text' id="address" value="신촌역" /> 
			<input type='button'id="geoSubmit" value="GeoCode"/>
		</div>
		<div id="gmap"></div>
	</div>
	<div id="gmap"></div>
<script>
	var addr = [ '서울 선유도','서울 뚝섬','서울 시청','서울 잠실종합운동장'];
	var home = [ 'https://www.daum.net','https://www.nate.com',
				 'https://www.seoul.go.kr','https://www.naver.com']
	var popImg=['n1.jpg','n2.jpg','n3.jpg','n4.jpg']
	var latitude = 37.5729503;
	var longitude = 126.9793578;
	
	var idx = 0; 
	
	function initMap() {
		var myCenter = new google.maps.LatLng(latitude, longitude);
		var option = {
			center : myCenter,
			zoom : 8,
			mapTypeId : google.maps.MapTypeId.ROADMAP
		}
		var map = new google.maps.Map(document.getElementById("gmap"),
				option);
		//지명을 이용한 지도 표시를 하기 위해서는 Geocoder객체가 필요하다.
		
		var geoCoder = new google.maps.Geocoder();
		var i=0;
		for (i = 0; i < addr.length; i++) {
			//주소, 팝업, 마커등을 객체에 셋팅해야됩니다
			geoCoder
					.geocode(
							{
								'address' : addr[i]
							},//마커를 표시할 주소 
							function(results, status) {//status='OK'이면 주소가 존재한다.
								if (status == 'OK') {//주소가 있을때
									//지도의 위치를 새로 셋팅 
									map.setCenter(results[0].geometry.location);
									//마커 
									var marker = new google.maps.Marker(
											{
												map : map,
												icon : 'gmap_pin.png',
												title : results[0]['formatted_address'],
												position : results[0].geometry.location
											});

									//팝업 : 위도, 경도, 주소 , 링크 
								var la = results[0]['geometry']['location']['lat']
											();// 위도 
								var lo = results[0]['geometry']['location']['lng']
											();//경도

								var popMsg = "위도 :" + la + "<br/>";
									popMsg += "경도 :" + lo + "<br/>";
									popMsg += "주소 :"+ (results[0]['formatted_address']).substring(5) + "<br/>";
									popMsg += "<a href='"+home[idx]+"'><img src='../../img/"+popImg[idx]+"'.jpg' width='80'height='50'/></a>"
									idx++;
									console.log(popMsg)
								var info = new google.maps.InfoWindow({
										content : popMsg
									});

									//팝업을 이벤트 처리 
									google.maps.event.addListener(marker,
											'mouseover', function() {
												info.open(map, marker)
											});
								} else {//주소가 없을때 
									alert("입력한 주소가 존재하지 않습니다 ...");
								}
							}

					);//Geocoder
		}//for
		//GeoCode버튼을 이벤트 등록
		document.getElementById("geoSubmit").addEventListener('click',function(){
			geocodeAddress(map,geoCoder);
		});
	}//initMap()
	function geocodeAddress(resultMap,geocode){
		var address = document.getElementById("address").value;
		geocode.geocode({'address':address},function(result, status){
			if(status=='OK'){
				resultMap.setCenter(result[0].geometry.location);
				var m = new google.maps.Marker({
					map:resultMap,
					position:result[0].geometry.location
				});
				
			}else{
				alert("존재하지 않는 주소입니다.."+status);
			}
		});
	}
	
	</script>
</body>
</html>
